# TODO

This file was generated by Claude Code and has not been tested yet. Please be advised that it is likely incomplete.

# Code Signing Setup for GitHub Actions

This document explains how to set up code signing for Fang installers on all platforms.

## Windows Code Signing

Windows code signing requires a code signing certificate from a trusted Certificate Authority (CA) such as DigiCert, Sectigo, or GlobalSign.

### Required GitHub Secrets

1. **`WINDOWS_CERT_BASE64`**: Your code signing certificate (.pfx or .p12 file) encoded in base64
   ```bash
   # On Linux/macOS:
   base64 -i your-cert.pfx | tr -d '\n' > cert-base64.txt

   # On Windows PowerShell:
   [Convert]::ToBase64String([IO.File]::ReadAllBytes("your-cert.pfx")) | Out-File -Encoding ASCII cert-base64.txt
   ```

2. **`WINDOWS_CERT_PASSWORD`**: The password for your certificate

### Required GitHub Variables

1. **`WINDOWS_SIGN_ENABLED`**: Set to `true` to enable Windows code signing

### How to Add Secrets

1. Go to your GitHub repository
2. Navigate to Settings → Secrets and variables → Actions
3. Click "New repository secret"
4. Add each secret listed above

## macOS Code Signing and Notarization

macOS code signing requires an Apple Developer account ($99/year) and a Developer ID certificate.

### Prerequisites

1. Enroll in the Apple Developer Program
2. Create a Developer ID Application certificate in your Apple Developer account
3. Export the certificate as a .p12 file
4. Create an app-specific password for notarization at appleid.apple.com

### Required GitHub Secrets

1. **`MACOS_CERT_BASE64`**: Your Developer ID certificate (.p12 file) encoded in base64
   ```bash
   base64 -i DeveloperID.p12 | tr -d '\n' > cert-base64.txt
   ```

2. **`MACOS_CERT_PASSWORD`**: The password for your certificate

3. **`MACOS_KEYCHAIN_PASSWORD`**: A temporary password for the build keychain (can be any random string)

4. **`MACOS_SIGNING_IDENTITY`**: The name of your signing identity (usually "Developer ID Application: Your Name (TEAM_ID)")
   ```bash
   # Find your signing identity:
   security find-identity -v -p codesigning
   ```

5. **`APPLE_ID`**: Your Apple ID email address

6. **`APPLE_APP_PASSWORD`**: An app-specific password generated at appleid.apple.com
   - Go to https://appleid.apple.com
   - Sign in
   - Security → App-Specific Passwords → Generate password
   - Label it "GitHub Actions Notarization"

7. **`APPLE_TEAM_ID`**: Your Apple Developer Team ID
   ```bash
   # Find your team ID at:
   # https://developer.apple.com/account/#!/membership
   ```

### Required GitHub Variables

1. **`MACOS_SIGN_ENABLED`**: Set to `true` to enable macOS code signing and notarization

## Linux AppImage Signing (Optional)

AppImage signing is optional and less critical than Windows/macOS signing. Most users don't verify AppImage signatures, but you can add GPG signing if desired.

This is not currently implemented but can be added if needed.

## Testing Code Signing Locally

### Windows

```powershell
# Test signing an executable
& "C:\Program Files (x86)\Windows Kits\10\bin\10.0.22621.0\x64\signtool.exe" sign `
  /f your-cert.pfx `
  /p "your-password" `
  /tr http://timestamp.digicert.com `
  /td sha256 `
  /fd sha256 `
  Fang.exe

# Verify signature
& "C:\Program Files (x86)\Windows Kits\10\bin\10.0.22621.0\x64\signtool.exe" verify /pa Fang.exe
```

### macOS

```bash
# Sign the app bundle
codesign --force --deep --sign "Developer ID Application: Your Name (TEAM_ID)" \
  --options runtime \
  --entitlements entitlements.plist \
  --timestamp \
  Fang.app

# Verify signature
codesign --verify --verbose Fang.app
spctl --assess --verbose Fang.app

# Test notarization (requires Xcode command line tools)
xcrun notarytool submit Fang.dmg \
  --apple-id "your@email.com" \
  --password "your-app-specific-password" \
  --team-id "YOUR_TEAM_ID" \
  --wait
```

## Disabling Code Signing

To build without code signing (for testing or if you don't have certificates):

1. Go to Settings → Secrets and variables → Actions → Variables
2. Either delete the `WINDOWS_SIGN_ENABLED` and `MACOS_SIGN_ENABLED` variables, or set them to `false`

The build will complete successfully without signing, but installers will show security warnings when users try to install them.

## Security Notes

- **Never commit certificates or passwords to the repository**
- Secrets are encrypted by GitHub and only exposed during workflow execution
- The temporary keychain on macOS is created and destroyed during the build
- Certificate files are deleted after signing

## Troubleshooting

### Windows: "No certificates were found that met all the given criteria"
- Verify your certificate is valid and not expired
- Check that the password is correct
- Ensure the certificate supports code signing

### macOS: "The specified item could not be found in the keychain"
- Verify your certificate is a "Developer ID Application" certificate
- Check the MACOS_SIGNING_IDENTITY matches exactly (including parentheses and team ID)
- Ensure the certificate password is correct

### macOS: Notarization fails
- Verify your Apple ID and app-specific password are correct
- Check that your Apple Developer account is active
- Ensure your Team ID is correct
- Review notarization logs: `xcrun notarytool log <submission-id>`
